<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [i3] i3 layout save/restore
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:i3-discuss%40i3.zekjur.net?Subject=Re%3A%20%5Bi3%5D%20i3%20layout%20save/restore&In-Reply-To=%3C85EA6F68AC24DA48B220EBEA7A8C08B81B506DA6%40corpmail01.corp.sensis.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=utf-8">
   <LINK REL="Previous"  HREF="001848.html">
   <LINK REL="Next"  HREF="001850.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[i3] i3 layout save/restore</H1>
    <B>Sargrad, Dave</B> 
    <A HREF="mailto:i3-discuss%40i3.zekjur.net?Subject=Re%3A%20%5Bi3%5D%20i3%20layout%20save/restore&In-Reply-To=%3C85EA6F68AC24DA48B220EBEA7A8C08B81B506DA6%40corpmail01.corp.sensis.com%3E"
       TITLE="[i3] i3 layout save/restore">Dave.Sargrad at saabsensis.com
       </A><BR>
    <I>Mon Sep 15 19:38:45 CEST 2014</I>
    <P><UL>
        <LI>Previous message: <A HREF="001848.html">[i3] i3 layout save/restore
</A></li>
        <LI>Next message: <A HREF="001850.html">[i3] i3-discuss Digest, Vol 53, Issue 5
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1849">[ date ]</a>
              <a href="thread.html#1849">[ thread ]</a>
              <a href="subject.html#1849">[ subject ]</a>
              <a href="author.html#1849">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>I've made a little progress with this generation of a json layout spec. Note that I am trying to be completely json compliant. So, unlike the i3-save-tree (which saves multiple json documents), I have a json spec that only has one json document. My reading of the i3 documentation seems to suggest that i3 has no problem with this, and it seems that it doesn't have a problem.

In the sample that I provided below I have reduced the spec to the following form:

{&quot;fullscreen_mode&quot;: 1, &quot;floating&quot;: &quot;auto_off&quot;, &quot;border&quot;: &quot;normal&quot;, &quot;layout&quot;: &quot;splith&quot;, &quot;percent&quot;: null, &quot;nodes&quot;: [{&quot;window_properties&quot;: {&quot;title&quot;: &quot;yo&quot;}, &quot;fullscreen_mode&quot;: 0, &quot;floating&quot;: &quot;auto_off&quot;, &quot;border&quot;: &quot;normal&quot;, &quot;layout&quot;: &quot;splith&quot;, &quot;percent&quot;: 0.5,  &quot;nodes&quot;: [], &quot;type&quot;: &quot;con&quot;, &quot;swallows&quot;: [{&quot;class&quot;: &quot;^XTerm$&quot;}], &quot;name&quot;: &quot;<A HREF="http://infra.in.zekjur.net/cgi-bin/mailman/listinfo/i3-discuss">ubuntu at example-8930</A>: ~&quot;, &quot;geometry&quot;: {&quot;y&quot;: 0, &quot;x&quot;: 0, &quot;height&quot;: 316, &quot;width&quot;: 484}}, {&quot;window_properties&quot;: {&quot;title&quot;: &quot;go&quot;}, &quot;fullscreen_mode&quot;: 0, &quot;floating&quot;: &quot;auto_off&quot;, &quot;border&quot;: &quot;normal&quot;,  &quot;layout&quot;: &quot;splith&quot;, &quot;percent&quot;: 0.5, &quot;nodes&quot;: [], &quot;type&quot;: &quot;con&quot;, &quot;swallows&quot;: [{&quot;class&quot;: &quot;^XTerm$&quot;}], &quot;name&quot;: &quot;<A HREF="http://infra.in.zekjur.net/cgi-bin/mailman/listinfo/i3-discuss">ubuntu at example-8930</A>: ~&quot;, &quot;geometry&quot;: {&quot;y&quot;: 0, &quot;x&quot;: 0, &quot;height&quot;: 316, &quot;width&quot;: 484}}], &quot;type&quot;: &quot;workspace&quot;, &quot;swallows&quot;: []}

Notice that this spec actually has 3 swallows one for the parent workspace and two for the 2 xterm leaf nodes. Not sure why this is, but it is what I received when I requested the tree. I3-save-tree (I think) only shows a swallows for leaf nodes.

I can actually append this document to a workspace (i3-msg &quot;workspace 2; append_layout /home/ubuntu/.i3/layout_spec&quot;) - i3 does not crash on this spec.

However I see two problems:
1] The spec actually overlays the workspace (rather than appending to it)
2] The windows do not swallow a subsequent xterm.

Why does this spec result in an &quot;overlay&quot; rather than an &quot;append&quot;?  Why is my swallow not working?

From: Sargrad, Dave
Sent: Monday, September 15, 2014 12:33 PM
To: '<A HREF="http://infra.in.zekjur.net/cgi-bin/mailman/listinfo/i3-discuss">i3-discuss at i3.zekjur.net</A>'
Subject: i3 layout save/restore

I am trying to generate my own layout files in python (similar to the files generated by i3-save-tree). I am looking for something that describes the layout specification [above and beyond the i3-save-tree code, which is a bit cryptic for a non-perl expert].

I am already able to get the i3 tree in python. Furthermore I already have a number of operations that I perform on that tree. For example I have an operation that generates an image (representing the workspace structure) for each workspace in the tree. I am at a point where I need to generate layout specs, so that I can subsequently append these to workspaces.

The first couple of specs that I generated are essentially just a dump of the portion of the portion of the tree that corresponds to the workspace. I know these need to be tweaked further. For example I have not yet added &quot;swallows&quot;, nor stripped non-necessary elements (like &quot;fullscreen_mode&quot; or &quot;layout&quot;). However I thought that i3 would allow me to load these specs and then I could begin to trim them and modify them until they looked more like the specs generated by i3-save-tree. Indeed I hoped that i3 might provide feedback relative to the elements of the spec that were not right.

The unfortunate thing is that i3 crashes when it attempts to load my specs. So rather than move from the form that I have incrementally towards the &quot;right form&quot;, I need to jump to the right form more quickly.

A specification for the layout structure would help. Is there anything that exists above and beyond the perl code, and the samples of generated layouts that I can create with it?

For example, here is the portion of the tree that corresponds to the workspace that I am trying to save a spec for: this particular simple workspace is one window on top of another.  Other than the obvious things like adding a proper swallows element, what are the key things that I need to keep in mind when transforming portions of the i3 tree into a form that can later be appended?

{&quot;fullscreen_mode&quot;: 1, &quot;orientation&quot;: &quot;horizontal&quot;, &quot;focus&quot;: [23160000, 23125184], &quot;urgent&quot;: false, &quot;num&quot;: 1, &quot;last_split_layout&quot;: &quot;splith&quot;, &quot;floating&quot;: &quot;auto_off&quot;, &quot;border&quot;: &quot;normal&quot;, &quot;id&quot;: 23119648, &quot;current_border_width&quot;: -1, &quot;layout&quot;: &quot;splith&quot;, &quot;percent&quot;: null, &quot;workspace_layout&quot;: &quot;default&quot;, &quot;window&quot;: null, &quot;nodes&quot;: [{&quot;window_properties&quot;: {&quot;instance&quot;: &quot;xterm&quot;, &quot;class&quot;: &quot;XTerm&quot;, &quot;title&quot;: &quot;<A HREF="http://infra.in.zekjur.net/cgi-bin/mailman/listinfo/i3-discuss">ubuntu at example-8930</A>: ~/playground/cwpmash&quot;}, &quot;fullscreen_mode&quot;: 0, &quot;orientation&quot;: &quot;none&quot;, &quot;focus&quot;: [], &quot;urgent&quot;: false, &quot;last_split_layout&quot;: &quot;splith&quot;, &quot;floating&quot;: &quot;auto_off&quot;, &quot;border&quot;: &quot;normal&quot;, &quot;id&quot;: 23125184, &quot;current_border_width&quot;: -1, &quot;layout&quot;: &quot;splith&quot;, &quot;percent&quot;: 0.5, &quot;workspace_layout&quot;: &quot;default&quot;, &quot;window&quot;: 25165860, &quot;nodes&quot;: [], &quot;type&quot;: &quot;con&quot;, &quot;swallows&quot;: [], &quot;focused&quot;: false, &quot;scratchpad_state&quot;: &quot;none&quot;, &quot;rect&quot;: {&quot;y&quot;: 18, &quot;x&quot;: 0, &quot;height&quot;: 1013, &quot;width&quot;: 840}, &quot;window_rect&quot;: {&quot;y&quot;: 0, &quot;x&quot;: 2, &quot;height&quot;: 1009, &quot;width&quot;: 834}, &quot;name&quot;: &quot;<A HREF="http://infra.in.zekjur.net/cgi-bin/mailman/listinfo/i3-discuss">ubuntu at example-8930</A>: ~/playground/cwpmash&quot;, &quot;geometry&quot;: {&quot;y&quot;: 0, &quot;x&quot;: 0, &quot;height&quot;: 316, &quot;width&quot;: 484}, &quot;floating_nodes&quot;: []}, {&quot;window_properties&quot;: {&quot;instance&quot;: &quot;xterm&quot;, &quot;class&quot;: &quot;XTerm&quot;, &quot;title&quot;: &quot;<A HREF="http://infra.in.zekjur.net/cgi-bin/mailman/listinfo/i3-discuss">ubuntu at example-8930</A>: ~&quot;}, &quot;fullscreen_mode&quot;: 0, &quot;orientation&quot;: &quot;none&quot;, &quot;focus&quot;: [], &quot;urgent&quot;: false, &quot;last_split_layout&quot;: &quot;splith&quot;, &quot;floating&quot;: &quot;auto_off&quot;, &quot;border&quot;: &quot;normal&quot;, &quot;id&quot;: 23160000, &quot;current_border_width&quot;: -1, &quot;layout&quot;: &quot;splith&quot;, &quot;percent&quot;: 0.5, &quot;workspace_layout&quot;: &quot;default&quot;, &quot;window&quot;: 27263012, &quot;nodes&quot;: [], &quot;type&quot;: &quot;con&quot;, &quot;swallows&quot;: [], &quot;focused&quot;: true, &quot;scratchpad_state&quot;: &quot;none&quot;, &quot;rect&quot;: {&quot;y&quot;: 18, &quot;x&quot;: 840, &quot;height&quot;: 1013, &quot;width&quot;: 840}, &quot;window_rect&quot;: {&quot;y&quot;: 0, &quot;x&quot;: 2, &quot;height&quot;: 1009, &quot;width&quot;: 834}, &quot;name&quot;: &quot;<A HREF="http://infra.in.zekjur.net/cgi-bin/mailman/listinfo/i3-discuss">ubuntu at example-8930</A>: ~&quot;, &quot;geometry&quot;: {&quot;y&quot;: 0, &quot;x&quot;: 0, &quot;height&quot;: 316, &quot;width&quot;: 484}, &quot;floating_nodes&quot;: []}], &quot;type&quot;: &quot;workspace&quot;, &quot;swallows&quot;: [], &quot;focused&quot;: false, &quot;scratchpad_state&quot;: &quot;none&quot;, &quot;rect&quot;: {&quot;y&quot;: 0, &quot;x&quot;: 0, &quot;height&quot;: 1031, &quot;width&quot;: 1680}, &quot;window_rect&quot;: {&quot;y&quot;: 0, &quot;x&quot;: 0, &quot;height&quot;: 0, &quot;width&quot;: 0}, &quot;name&quot;: &quot;1&quot;, &quot;geometry&quot;: {&quot;y&quot;: 0, &quot;x&quot;: 0, &quot;height&quot;: 0, &quot;width&quot;: 0}, &quot;floating_nodes&quot;: []}

The correct form (as generated by i3-save-tree) is:

// vim:ts=4:sw=4:et
{
    &quot;border&quot;: &quot;normal&quot;,
    &quot;floating&quot;: &quot;auto_off&quot;,
    &quot;geometry&quot;: {
       &quot;height&quot;: 316,
       &quot;width&quot;: 484,
      &quot;x&quot;: 0,
       &quot;y&quot;: 0
    },
    &quot;name&quot;: &quot;<A HREF="http://infra.in.zekjur.net/cgi-bin/mailman/listinfo/i3-discuss">ubuntu at example-8930</A>: ~/playground/cwpmash&quot;,
    &quot;percent&quot;: 0.5,
    &quot;swallows&quot;: [
       {
       // &quot;class&quot;: &quot;^XTerm$&quot;,
       // &quot;instance&quot;: &quot;^xterm$&quot;,
       // &quot;title&quot;: &quot;^ubuntu\\@example\\-8930\\:\\ \\~\\/playground\\/cwpmash$&lt;<A HREF="file:///\\~\playground\cwpmash$">file:///\\~\playground\cwpmash$</A>&gt;&quot;
       }
    ],
    &quot;type&quot;: &quot;con&quot;
}

{
    &quot;border&quot;: &quot;normal&quot;,
    &quot;floating&quot;: &quot;auto_off&quot;,
    &quot;geometry&quot;: {
       &quot;height&quot;: 316,
       &quot;width&quot;: 484,
       &quot;x&quot;: 0,
       &quot;y&quot;: 0
    },
    &quot;name&quot;: &quot;<A HREF="http://infra.in.zekjur.net/cgi-bin/mailman/listinfo/i3-discuss">ubuntu at example-8930</A>: ~&quot;,
    &quot;percent&quot;: 0.5,
    &quot;swallows&quot;: [
       {
       // &quot;class&quot;: &quot;^XTerm$&quot;,
       // &quot;instance&quot;: &quot;^xterm$&quot;,
       // &quot;title&quot;: &quot;^ubuntu\\@example\\-8930\\:\\ \\~$&quot;
       }
    ],
    &quot;type&quot;: &quot;con&quot;
}

<A HREF="http://i3wm.org/docs/layout-saving.html#_saving_the_layout">http://i3wm.org/docs/layout-saving.html#_saving_the_layout</A>



This message is intended only for the addressee and may contain information that is company confidential or privileged. Any technical data in this message may be exported only in accordance with the U.S. International Traffic in Arms Regulations (22 CFR Parts 120-130) or the Export Administration Regulations (15 CFR Parts 730-774). Unauthorized use is strictly prohibited and may be unlawful. If you are not the intended recipient, or the person responsible for delivering to the intended recipient, you should not read, copy, disclose or otherwise use this message. If you have received this email in error, please delete it, and advise the sender immediately.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://infra.in.zekjur.net/pipermail/i3-discuss/attachments/20140915/4450c667/attachment-0001.html">http://infra.in.zekjur.net/pipermail/i3-discuss/attachments/20140915/4450c667/attachment-0001.html</A>&gt;
</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="001848.html">[i3] i3 layout save/restore
</A></li>
	<LI>Next message: <A HREF="001850.html">[i3] i3-discuss Digest, Vol 53, Issue 5
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1849">[ date ]</a>
              <a href="thread.html#1849">[ thread ]</a>
              <a href="subject.html#1849">[ subject ]</a>
              <a href="author.html#1849">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://infra.in.zekjur.net/cgi-bin/mailman/listinfo/i3-discuss">More information about the i3-discuss
mailing list</a><br>
</body></html>
